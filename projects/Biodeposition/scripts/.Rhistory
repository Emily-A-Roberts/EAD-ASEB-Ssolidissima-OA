#| include: false
library(ggplot2)
library(ggpubr)
library(data.table)
setwd("~/GitHub/EAD-ASEB-Ssolidissima-OA/data")
bd <- fread("Biodeposition_experiment_summary - Biodeposition_results.csv")
# bd <- bd[!is.na(bd$Month),]
# bd <- bd[!is.na(bd$Site),]
#print(rownames(bd))
#bd <- bd[complete.cases(bd), ]
bd<- bd[bd$Month =="September"|bd$Month =="April"|bd$Month =="June",]
bd$Site <- as.factor(bd$Site)
bd$Month <- as.factor(bd$Month)
bd$Month <- factor(bd$Month, levels=c("September", "April", "June"))
bd$Treatment <- as.factor(bd$Treatment)
bd$Treatment <- factor(bd$Treatment, levels=c("N", "S", "OUT"))
#print(rownames(bd))
#bd$Treatment[bd$Site=="Eel Pond"] <- "N"
bd <- bd[bd$TPM>=.9,]
#bd$OER
#str(bd)
#| echo: false
gg1 <- ggplot(data = bd, aes(x=Dry.weight, y=OER, color = Month))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
ylab("OER")+
#ylim(0,9)+
#scale_color_discrete(name="Site")+
#ggtitle ('OER as a function of DW')+
facet_wrap(~ Site)
gg1
#| include: false
library(ggplot2)
library(ggpubr)
library(data.table)
setwd("~/GitHub/EAD-ASEB-Ssolidissima-OA/projects/Biodeposition/data")
bd <- fread("Biodeposition_experiment_summary - Biodeposition_results.csv")
#| include: false
library(ggplot2)
library(ggpubr)
library(data.table)
setwd("~/GitHub/EAD-ASEB-Ssolidissima-OA/projects/Biodeposition/data")
bd <- fread("Biodeposition_experiment_summary - Biodeposition_results.csv")
# bd <- bd[!is.na(bd$Month),]
# bd <- bd[!is.na(bd$Site),]
#print(rownames(bd))
#bd <- bd[complete.cases(bd), ]
bd<- bd[bd$Month =="September"|bd$Month =="April"|bd$Month =="June",]
bd$Site <- as.factor(bd$Site)
bd$Month <- as.factor(bd$Month)
bd$Month <- factor(bd$Month, levels=c("September", "April", "June"))
bd$Treatment <- as.factor(bd$Treatment)
bd$Treatment <- factor(bd$Treatment, levels=c("N", "S", "OUT"))
#print(rownames(bd))
#bd$Treatment[bd$Site=="Eel Pond"] <- "N"
bd <- bd[bd$TPM>=.9,]
#bd$OER
#str(bd)
#| echo: false
gg1 <- ggplot(data = bd, aes(x=Dry.weight, y=OER, color = Month))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
ylab("OER")+
#ylim(0,9)+
#scale_color_discrete(name="Site")+
#ggtitle ('OER as a function of DW')+
facet_wrap(~ Site)
gg1
gg1 <- ggplot(data = bd, aes(x=Dry.weight, y=IER, color = Month))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
ylab("IER")+
#ylim(0,9)+
#scale_color_discrete(name="Site")+
#ggtitle ('OER as a function of DW')+
facet_wrap(~ Site)
gg1
gg1 <- ggplot(data = bd, aes(x=Dry.weight, y=f, color = Month))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
ylab("organic content of water (mg/L)")+
ylim(0,1)+
#scale_color_discrete(name="Site")+
#ggtitle ('OER as a function of DW')+
facet_wrap(~ Site)
gg1
gg1 <- ggplot(data = bd, aes(x=Length, y=Dry.weight, color = Month))+
geom_point(aes(shape=Treatment))+
#xlab("Dry weight") +
#ylab("organic content of water (mg/L)")+
#ylim(0,1)+
#scale_color_discrete(name="Site")+
#ggtitle ('OER as a function of DW')+
facet_wrap(~ Site)
gg1
gg1 <- ggplot(data = bd, aes(x=Dry.weight, y=OER/Dry.weight^.43, color = Month))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
#ylab("OER new scaling")+
#ylim(0,9)+
#scale_color_discrete(name="Site")+
#ggtitle ('OER as a function of DW')+
facet_wrap(~ Site)
gg1
gg1 <- ggplot(data = bd, aes(x=Dry.weight, y=IER/Dry.weight^.59, color = Month))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
# ylab("IER")+
#ylim(0,9)+
#scale_color_discrete(name="Site")+
#ggtitle ('OER as a function of DW')+
facet_wrap(~ Site)
gg1
gg1 <- ggplot(data = bd, aes(x=Dry.weight, y=ORR, color = Month))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
#ylab("ORR")+
#ylim(0,9)+
#scale_color_discrete(name="Site")+
#ggtitle ('OER as a function of DW')+
facet_wrap(~ Site)
gg1
gg1 <- ggplot(data = bd, aes(x=Dry.weight, y=IRR, color = Month))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
# ylab("IRR")+
#ylim(0,9)+
#scale_color_discrete(name="Site")+
#ggtitle ('OER as a function of DW')+
facet_wrap(~ Site)
gg1
gg1 <- ggplot(data = bd, aes(x=Length/10, y=OER/(0.096*(Length/10)^1.93), color = Month))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
#ylab("OER new scaling")+
#ylim(0,9)+
#scale_color_discrete(name="Site")+-
#ggtitle ('OER as a function of DW')+
facet_wrap(~ paste(Site,Month))
gg1
gg1 <- ggplot(data = bd, aes(x=Length/10, y=IER/(.44*(Length/10)^2.17), color = Month))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
#ylab("OER new scaling")+
#ylim(0,9)+
#scale_color_discrete(name="Site")+-
#ggtitle ('OER as a function of DW')+
facet_wrap(~ paste(Site,Month))
gg1
gg1 <- ggplot(data = bd, aes(x=Length/10, y=OER/(Length/10)^2, color = Month))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
# ylab("IER")+
#ylim(0,9)+
#scale_color_discrete(name="Site")+
#ggtitle ('OER as a function of DW')+
facet_wrap(~ paste(Site,Month))
gg1
gg1 <- ggplot(data = bd, aes(x=Length/10, y=IER/(Length/10)^2, color = Month))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
# ylab("IER")+
#ylim(0,9)+
#scale_color_discrete(name="Site")+
#ggtitle ('OER as a function of DW')+
facet_wrap(~ paste(Site,Month))
gg1
gg1 <- ggplot(data = bd, aes(x=Length/10, y=ORR, color = Month))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
#ylab("ORR")+
#ylim(0,9)+
#scale_color_discrete(name="Site")+
#ggtitle ('OER as a function of DW')+
facet_wrap(~ paste(Site,Month))
gg1
gg1 <- ggplot(data = bd, aes(x=Length/10, y=IRR, color = Month))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
# ylab("IRR")+
#ylim(0,9)+
#scale_color_discrete(name="Site")+
#ggtitle ('OER as a function of DW')+
facet_wrap(~ paste(Site,Month))
gg1
#| echo: false
bd$Treatment
gg1 <- ggplot(data = bd, aes(x=Dry.weight, y=OER_scaled, color = Month))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
ylab("OER_scaled")+
#ylim(0,9)+
#scale_color_discrete(name="Site")+
#ggtitle ('OER as a function of DW')+
facet_wrap(~ Site)
gg1
bd$Treatment
gg1 <- ggplot(data = bd, aes(x=Dry.weight, y=IER_scaled, color = Month))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
ylab("IER_scaled")+
#ylim(0,9)+
#scale_color_discrete(name="Site")+
#ggtitle ('OER as a function of DW')+
facet_wrap(~ Site)
gg1
bd$Treatment
gg1 <- ggplot(data = bd, aes(x=Dry.weight, y=CR, color = Treatment))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
ylab("CR scaled")+
#ylim(0,9)+
#scale_color_discrete(name="Site")+
#ggtitle ('OER as a function of DW')+
facet_wrap(~ Site)
gg1
gg1 <- ggplot(data = bd, aes(x=Dry.weight, y=CR*Dry.weight^.76, color = Month ))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
ylab("CR")+
ylim(0,2.5)+
scale_color_discrete(name="Site")+
ggtitle ('Unscaled CR as a function of DW')+
facet_wrap(~ Site)
gg1
gg2 <- ggplot(data = bd, aes(x=Dry.weight, y=CR, color = Month ))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
ylab("CR")+
#ylim(0,9)+
scale_color_discrete(name="Site")+
ggtitle ('Scaled CR as a function of DW')+
facet_wrap(~ Site)
gg2
gg3 <- ggplot(data = bd, aes(x=Site, y=CR, col = Treatment))+
geom_boxplot()+
#xlab("Dry weight") +
ylab("Clearance Rate")+
ylim(0,6)+
scale_color_discrete(name="Site")+
ggtitle ('Scaled CR')+
facet_wrap(~ Month)
gg3
gg4 <- ggplot(data = bd, aes(x=Site, y=CR*Dry.weight^.76, col = Treatment))+
geom_boxplot()+
#xlab("Dry weight") +
ylab("Clearance Rate")+
ylim(0,3)+
scale_color_discrete(name="Site")+
ggtitle ('Unscaled CR')+
facet_wrap(~ Month)
gg4
gg1 <- ggplot(data = bd, aes(x=Dry.weight, y=AR*Dry.weight^.76, color = Month ))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
ylab("AR")+
ylim(0,2.5)+
scale_color_discrete(name="Site")+
ggtitle ('Unscaled AR as a function of DW')+
facet_wrap(~ Site)
gg1
gg2 <- ggplot(data = bd, aes(x=Dry.weight, y=AR, color = Month ))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
ylab("AR")+
#ylim(0,9)+
scale_color_discrete(name="Site")+
ggtitle ('Scaled AR as a function of DW')+
facet_wrap(~ Site)
gg2
gg2 <- ggplot(data = bd, aes(x=Dry.weight, y=AR, color = Site ))+
geom_point(aes(shape=Treatment))+
xlab("Dry weight") +
ylab("AR")+
#ylim(0,9)+
scale_color_discrete(name="Site")+
ggtitle ('Scaled AR as a function of DW')+
facet_wrap(~ Month)
gg2
gg3 <- ggplot(data = bd, aes(x=Site, y=AR, col = Treatment))+
geom_boxplot()+
xlab("Dry weight") +
ylab("AR")+
ylim(0,6)+
scale_color_discrete(name="Site")+
ggtitle ('Scaled AR')+
facet_wrap(~ Month)
gg3
gg4 <- ggplot(data = bd, aes(x=Site, y=AR*Dry.weight^.76, col = Treatment))+
geom_boxplot()+
xlab("Dry weight") +
ylab("AR")+
ylim(0,3)+
scale_color_discrete(name="Site")+
ggtitle ('Unscaled AR')+
facet_wrap(~ Month)
gg4
gg4 <- ggplot(data = bd, aes(x=Site, y=AR*Dry.weight^.76, col = Site))+
geom_boxplot()+
#xlab("Dry weight") +
ylab("AR")+
ylim(0,3)+
scale_color_discrete(name="Site")+
ggtitle ('Unscaled AR')+
facet_wrap(~ Month)
gg4
gm1 <- lm(AR*Dry.weight^.76 ~ Site*Dry.weight*Month+Treatment,
data = bd)
gm2 <- lm(AR*Dry.weight^.76 ~ Site+Dry.weight,
data = bd)
gm3 <- lm(AR ~ Treatment,
data = bd[bd$Site=="Provincetown",]) #Separate analysis on Provincetown to confirm no difference in feeding rates between treatments.
summary(gm1)
summary(gm2)
summary(gm3)
gm2 <- lm(AR*Dry.weight^.76 ~ Site*Dry.weight,
data = bd)
summary(gm2)
gm2 <- lm(AR*Dry.weight^.76 ~ Site+Dry.weight,
data = bd)
summary(gm2)
#effects(gm2)
gg4 <- ggplot(data = bd, aes(x=Dry.weight, y=AR*Dry.weight^.76, col = Month))+
geom_point()+
geom_abline(slope = coef(gm2)[["Dry.weight"]],
intercept = coef(gm2)[["(Intercept)"]])+
xlab("Dry weight") +
ylab("AR")+
ylim(0,3)+
scale_color_discrete(name="Site")+
ggtitle ('Unscaled AR')
#+
#facet_wrap(~ Site)
gg4
gg1 <- ggplot(data = bd, aes(x=Site, y=AE, col = Treatment))+
geom_boxplot()+
xlab("Site") +
ylab("AE")+
ylim(0,1)+
scale_color_discrete(name="Site")+
ggtitle (' AE')+
facet_wrap(~ Site)
gg1
gg1 <- ggplot(data = bd, aes(x=Dry.weight, y=AE, col = Treatment))+
geom_point()+
xlab("Site") +
ylab("AE")+
ylim(0,1)+
scale_color_discrete(name="Site")+
ggtitle (' AE')+
facet_wrap(~ Site)
gg1
gg1 <- ggplot(data = bd, aes(x=Length, y=AE, col = Treatment))+
geom_point()+
xlab("Site") +
ylab("AE")+
ylim(0,1)+
scale_color_discrete(name="Site")+
ggtitle (' AE')+
facet_wrap(~ Site)
gg1
fit1 <- nlme::gnls(OER~ A*(Length/10)^B,
params = list(A~paste(Site,Month)-1, B~1),
data=bd,
na.action = na.exclude,
start = list(A=c(1,1,1,1,1,1), B = .3 ))
summary(fit1)
# fit2 <- nlme::gnls(OER~ A*(Length/10)^B,
#            params = list(A~paste(Site,Month)-1, B~paste(Site,Month)-1),
#            data=bd,
#            na.action = na.exclude,
#            start = list(A=c(1,1,1,1,1,1), B = c(1,1,1,1,1,1) ))
# summary(fit2)
fit3 <- nlme::gnls(OER~ A*(Length/10)^B,
params = list(A~1, B~1),
data=bd,
na.action = na.exclude,
start = list(A=1, B = .3 ))
summary(fit1)
summary(fit3)
AIC(fit1,fit3)
BIC(fit1,fit3)
gg1 <- ggplot(data = bd, aes(x=Length/10, y=OER, color = paste(Site,Month)))+
geom_point()+
#xlab("Dry weight") +
#ylab("ORR")+
#ylim(0,9)+
#scale_color_discrete(name="Site")+
#ggtitle ('ORR as a function of DW')+
stat_smooth(
method = 'nls',
formula = y ~ A * x^B,
method.args = list(start = c(A = 2.3, B = 2)),
se = FALSE
) +
facet_wrap(~ paste(Site,Month))
gg1
fit1 <- nlme::gnls(CR*Dry.weight^.76~ A*(Length/10)^B,
params = list(A~paste(Site,Month)-1, B~1),
data=bd,
na.action = na.exclude,
start = list(A=c(1,1,1,1,1,1), B = .3 ))
summary(fit1)
fit2 <- nlme::gnls(CR*Dry.weight^.76~ A*(Length/10)^B,
params = list(A~paste(Site,Month)-1, B~paste(Site,Month)-1),
data=bd,
na.action = na.exclude,
start = list(A=c(1,1,1,1,1,1), B = c(1,1,1,1,1,1) ))
summary(fit2)
fit3 <- nlme::gnls(CR*Dry.weight^.76~ A*(Length/10)^B,
params = list(A~1, B~1),
data=bd,
na.action = na.exclude,
start = list(A=1, B = .3 ))
summary(fit1)
summary(fit3)
AIC(fit1,fit3)
BIC(fit1,fit3)
gg1 <- ggplot(data = bd, aes(x=Length/10, y=CR*Dry.weight^.76, color = paste(Site,Month)))+
geom_point()+
#xlab("Dry weight") +
#ylab("ORR")+
#ylim(0,9)+
#scale_color_discrete(name="Site")+
#ggtitle ('ORR as a function of DW')+
stat_smooth(
method = 'nls',
formula = y ~ A * x^B,
method.args = list(start = c(A = 2.3, B = 2)),
se = FALSE
) +
facet_wrap(~ paste(Site,Month))
gg1
library(ggplot2)
library(ggpubr)
library(nlme)
library(data.table)
setwd("~/GitHub/EAD-ASEB-Ssolidissima-OA/projects/Biodeposition/data")
bd_Pousse <- read.csv("Pousse_Meseck_Raw Data Surfclam Biodeposition.csv", stringsAsFactors = FALSE, header = TRUE)
bd_Pousse$Dry.weight..mg. <- bd_Pousse$DW_corr
str(bd_Pousse)
bd_Pousse$Treatment <- as.factor(bd_Pousse$pH)
bd_Pousse$OER[bd_Pousse$OER<=-.5]<-NA
bd_Pousse$IER[bd_Pousse$IER<=-.5]<-NA
bd_Pousse$Dry.weight..mg.[bd_Pousse$Dry.weight..mg.>=.5]<-NA
ambient <- bd_Pousse[bd_Pousse$Treatment==8,]
gg1 <- ggplot(data = bd_Pousse, aes(x=Length..mm., y=Dry.weight..mg., color = Treatment))+ geom_point()
gg1
bd_Pousse$Treatment <- as.factor(bd_Pousse$pH)
bd_Pousse$Date <- as.Date(bd_Pousse$Date, format = "%m/%d/%Y")
bd_Pousse$Date[bd_Pousse$Date=="2019-06-12"] <-"2019-06-11"
bd_Pousse$Month <- as.factor(bd_Pousse$Date)
nls <- nls(Dry.weight..mg. ~ A * Length..mm.^B,
start = list(A = 3, B = 3),
data = bd_Pousse,
na.action=na.exclude)
summary(nls)
2.652*.76
#Note the summary data does not have length included, so am getting the relationship between length and dry weight separately.
#This file has PIMs, but I don't think I'm correctly calculating CR from IFR using these PIMs. There must be something I'm missing. The PIMs seem very high (by an order of 10), and the scaling factor seems higher than expected (3+).
#Based on my calculations of IFR and CR and accounting for month (different coefficients for the different months), I got a value of 2.5 +- .5 for the scaling factor.
#| include: FALSE
library(ggplot2)
library(ggpubr)
library(dplyr)
library(lubridate)
data_combined_new <- data.frame(
Site = NA,
Date = NA,
Temp = NA,
pH = NA
)
# working directories
wdDen <- "~/Documents/GitHub/EAD-ASEB-Ssolidissima-OA/data/HOBOpHdata/Dennis"
wdPtown <- "~/Documents/GitHub/EAD-ASEB-Ssolidissima-OA/data/HOBOpHdata/Ptown"
wdEel <- "~/Documents/GitHub/EAD-ASEB-Ssolidissima-OA/data/HOBOpHdata/Eel_Pond"
setwd(wdDen)
