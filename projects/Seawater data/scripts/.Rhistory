#           Chl_SE = sqrt(sum(Chl_SE^2)),
#
#           )
#filter_TSM$Date.factor
df_month <- filter_TSM %>%
group_by(Site,Month = lubridate::floor_date(as.Date(Date.factor), "month")) %>%
summarise(
POM = round(mean(AFDW.mg.L, na.rm = TRUE),1),
POM_SE = round(sd(AFDW.mg.L, na.rm = TRUE) /
sqrt(sum(!is.na(AFDW.mg.L))),1),
Chl = round(mean(ChlPOMRatio, na.rm = TRUE),1),
Chl_SE = round(sd(ChlPOMRatio, na.rm = TRUE) /
sqrt(sum(!is.na(ChlPOMRatio))),1)
)
p<- ggplot(df_month, aes(x=as.Date(Month), y=POM, group=Site, color=Site)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=POM-POM_SE, ymax=POM+POM_SE), width=.2,
position=position_dodge(0.05))
p+labs(x="Date", y = "POM (mg/L)")+
theme_classic() +
scale_color_manual(values = new.pal)
p<- ggplot(df_month, aes(x=as.Date(Month), y=Chl, group=Site, color=Site)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=Chl-Chl_SE, ymax=Chl+Chl_SE), width=.2,
position=position_dodge(0.05))
p+labs(x="Date", y = "Total Chl (ug/L) to POM (mg / L) ratio")+
theme_classic() +
scale_color_manual(values = new.pal)
#| echo: false
library(reshape2)
library(dplyr)
library(ggplot2)
library(tibble)
library("ggsci")
library(knitr)
#| echo: false
par(mar = c(1, 3.5, 1, 1))
new.pal <- c(pal_jco()(10)[4],pal_jco()(10)[6],pal_jco()(10)[5],pal_jco()(10)[2],'grey57','grey80')
#barplot(1:10, col = pal_jco()(10))
new.pal <- c("blue","black","orange","red","green")
dir1 <- "~/GitHub/EAD-ASEB-Ssolidissima-OA/projects/Seawater data/data/TSM and Chl/"
filter_TSM<- read.csv(paste(dir1,"TSM and Chl data - TSM filters.csv",sep = ""), header = TRUE, stringsAsFactors = FALSE)
filter_TSM <- filter_TSM[!is.na(filter_TSM$Site),]
filter_TSM <- filter_TSM[!is.na(filter_TSM$Date),]
# Separate out header row with unit information from dataframe
unit <- filter_TSM[1,]
filter_TSM <- filter_TSM[2:nrow(filter_TSM),]
str(filter_TSM)
#Save site label info
filter_TSM$Site.info <- filter_TSM$Site
#Categorize site
filter_TSM <- filter_TSM[filter_TSM$Site!="Unknown"&filter_TSM$Site!="Popponesset Bay",]
filter_TSM$Site[filter_TSM$Site=="Cockle Cove"] <- "Chatham"
filter_TSM$Site[filter_TSM$Site=="Cockle cove"] <- "Chatham"
#filter_TSM$Site[filter_TSM$Site=="Nobscussett"] <- "Dennis"
filter_TSM$Site[filter_TSM$Site=="Nobscusset"] <- "Nobscussett"
filter_TSM$Site[filter_TSM$Site=="Chatham all"] <- "Chatham"
filter_TSM$Site[filter_TSM$Site=="East Dennis"] <- "Dennis"
filter_TSM$Site[filter_TSM$Site=="Eden"] <- "Dennis"
filter_TSM$Site[filter_TSM$Site=="Provincetown collection site"] <- "Provincetown"
filter_TSM$Site[filter_TSM$Site=="Ptown"] <- "Provincetown"
filter_TSM$Site[filter_TSM$Site=="Sea street"] <- "Dennis"
filter_TSM$Site[filter_TSM$Site=="South st Dennis"] <- "Dennis"
filter_TSM$Site[filter_TSM$Site=="Barn"] <- "Barnstable"
filter_TSM$Site[filter_TSM$Site=="Barnstable Harbor"] <- "Barnstable"
filter_TSM <- filter_TSM[!is.na(filter_TSM$Site),]
filter_TSM <- filter_TSM[filter_TSM$Site!="Nobscussett",]
#Dataframe formatting
filter_TSM$Site <- as.factor(filter_TSM$Site)
filter_TSM$Site <- factor(filter_TSM$Site, levels=c('Provincetown', 'Dennis', "Nobscussett", 'Barnstable', "Chatham","Eel Pond"))
filter_TSM$Date <- as.Date(filter_TSM$Date, format = "%m/%d/%Y")
filter_TSM$Date.factor <- as.factor(filter_TSM$Date)
filter_TSM$AFDW.mg.L <- as.numeric(filter_TSM$AFDW.mg.L)
filter_TSM$TSM_mg.L <- as.numeric(filter_TSM$TSM_mg.L)
#QC step
filter_TSM <- filter_TSM[filter_TSM$POM..ug...L.>0,]
#filter_TSM <- filter_TSM[filter_TSM$Date>as.Date("1/1/21", format = "%m/%d/%Y"),]
filter_TSM$ChlPOMRatio <- filter_TSM$Chl.measured.ug.L/filter_TSM$AFDW.mg.L
str(filter_TSM)
filter_TSM$Site <- factor(filter_TSM$Site, levels=c('Barnstable', 'Dennis', 'Provincetown',"Chatham", "Eel Pond"))
levels(filter_TSM$Site) <- c('N. Cape: Barnstable Harbor', 'N. Cape: East Dennis', 'N. Cape: Provincetown Bay', "S. Cape: Cockle Cove, Chatham", "S. Cape: Eel Pond E Falmouth")
df_summary <- filter_TSM %>%
group_by(Site) %>%
summarise(
POM = round(mean(AFDW.mg.L, na.rm = TRUE),1),
POM_SE = round(sd(AFDW.mg.L, na.rm = TRUE) /
sqrt(sum(!is.na(AFDW.mg.L))),1),
TSM = round(mean(TSM_mg.L, na.rm = TRUE),1),
TSM_SE = round(sd(TSM_mg.L, na.rm = TRUE) /
sqrt(sum(!is.na(TSM_mg.L))),1),
Perc_org = round(mean(X..organic, na.rm = TRUE)*100,0),
Perc_SE = round(sd(X..organic*100, na.rm = TRUE) /
sqrt(sum(!is.na(X..organic))),0),
Chl = round(mean(ChlPOMRatio, na.rm = TRUE),1),
Chl_SE = round(sd(ChlPOMRatio, na.rm = TRUE) /
sqrt(sum(!is.na(ChlPOMRatio))),1)
)
kable(df_summary)
df_summary <- filter_TSM %>%
group_by(Site,Date.factor) %>%
summarise(
POM = round(mean(AFDW.mg.L, na.rm = TRUE),1),
POM_SE = round(sd(AFDW.mg.L, na.rm = TRUE) /
sqrt(sum(!is.na(AFDW.mg.L))),1),
TSM = round(mean(TSM_mg.L, na.rm = TRUE),1),
TSM_SE = round(sd(TSM_mg.L, na.rm = TRUE) /
sqrt(sum(!is.na(TSM_mg.L))),1),
Perc_org = round(mean(X..organic, na.rm = TRUE)*100,0),
Perc_SE = round(sd(X..organic*100, na.rm = TRUE) /
sqrt(sum(!is.na(X..organic))),0),
Chl = round(mean(ChlPOMRatio, na.rm = TRUE),1),
Chl_SE = round(sd(ChlPOMRatio, na.rm = TRUE) /
sqrt(sum(!is.na(ChlPOMRatio))),1)
)
kable(df_summary)
tail(df_summary)
df_summary$Date.factor <- as.Date(df_summary$Date.factor)
p<- ggplot(df_summary, aes(x=as.Date(Date.factor), y=POM, group=Site, color=Site)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=POM-POM_SE, ymax=POM+POM_SE), width=.2,
position=position_dodge(0.05))
p+labs(x="Date", y = "POM (mg/L)")+
theme_classic() +
scale_color_manual(values = new.pal)
df_month[!is.na(df_month$Site,),]
df_month[!is.na(df_month$Site),]
df_month <- df_month[!is.na(df_month$Site),]
# df_month <- df_summary %>%
# group_by(Site,Month = lubridate::floor_date(Date.factor, "month")) %>%
# summarize(POM = mean(POM),
#           POM_SE = sqrt(sum(POM_SE^2)),
#           Chl = mean(Chl),
#           Chl_SE = sqrt(sum(Chl_SE^2)),
#
#           )
#filter_TSM$Date.factor
df_month <- filter_TSM %>%
group_by(Site,Month = lubridate::floor_date(as.Date(Date.factor), "month")) %>%
summarise(
POM = round(mean(AFDW.mg.L, na.rm = TRUE),1),
POM_SE = round(sd(AFDW.mg.L, na.rm = TRUE) /
sqrt(sum(!is.na(AFDW.mg.L))),1),
Chl = round(mean(ChlPOMRatio, na.rm = TRUE),1),
Chl_SE = round(sd(ChlPOMRatio, na.rm = TRUE) /
sqrt(sum(!is.na(ChlPOMRatio))),1)
)
df_month <- df_month[!is.na(df_month$Site),]
p<- ggplot(df_month, aes(x=as.Date(Month), y=POM, group=Site, color=Site)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=POM-POM_SE, ymax=POM+POM_SE), width=.2,
position=position_dodge(0.05))
p+labs(x="Date", y = "POM (mg/L)")+
theme_classic() +
scale_color_manual(values = new.pal)
p<- ggplot(df_month, aes(x=as.Date(Month), y=Chl, group=Site, color=Site)) +
geom_line() +
geom_point()+
geom_errorbar(aes(ymin=Chl-Chl_SE, ymax=Chl+Chl_SE), width=.2,
position=position_dodge(0.05))
p+labs(x="Date", y = "Total Chl (ug/L) to POM (mg / L) ratio")+
theme_classic() +
scale_color_manual(values = new.pal)
plot(length~jitter(ages,0.8),data=clam_data_clean,subset=site=="Barnstable Harbor",pch=19,
xlab="Age (yrs)",ylim = c(0,18), xlim = c(0,13), col = "blue",
ylab="Total Length (mm)"
#,
#ylim = c(0,200), xlim = c(0,15)
)
points(length~jitter(ages,0.8),data = clam_data_clean,subset = site == "Cockle Cove, Chatham",pch=19,col="red")
points(length~jitter(ages,0.8),data = clam_data_clean,subset = site == "East Dennis",pch=19,col="black")
points(length~jitter(ages,0.8),data = clam_data_clean,subset = site == "Eel Pond E. Falmouth",pch=19,col="green")
points(length~jitter(ages,0.8),data = clam_data_clean,subset = site == "Provincetown Bay",pch=19,col="orange")
# points(length~jitter(ages,0.8), data = clam_data_clean, pch = 19, col = "grey")
vbTypical <- vbFuns("typical")
# fot fit1KT
# overview(fit1KT)
# coef(fit1KT)
# coef1 <- c(coef(fit1KT)[1], coef(fit1KT)[2], coef(fit1KT)[7])
# coef2 <- c(coef(fit1KT)[1], coef(fit1KT)[3], coef(fit1KT)[8])
# coef3 <- c(coef(fit1KT)[1], coef(fit1KT)[4], coef(fit1KT)[9])
# coef4 <- c(coef(fit1KT)[1], coef(fit1KT)[5], coef(fit1KT)[10])
# coef5 <- c(coef(fit1KT)[1], coef(fit1KT)[6], coef(fit1KT)[11])
# for fit1LK
overview(fit1LK)
coef(fit1LK)
coef1 <- c(coef(fit1LK)[1], coef(fit1LK)[6], coef(fit1LK)[11]) #Barnstable
coef2 <- c(coef(fit1LK)[2], coef(fit1LK)[7], coef(fit1LK)[11]) #Chatham
coef3 <- c(coef(fit1LK)[3], coef(fit1LK)[8], coef(fit1LK)[11]) #Dennis
coef4 <- c(coef(fit1LK)[4], coef(fit1LK)[9], coef(fit1LK)[11]) #Eel Pond
coef5 <- c(coef(fit1LK)[5], coef(fit1LK)[10], coef(fit1LK)[11]) #Provincetown
coef_avg <- c(mean(coef(fit1LK)[1:5]), mean(coef(fit1LK)[6:10]), coef(fit1LK)[11])
curve(vbTypical(x,Linf=coef1),from=0,to=20,lwd=2, col="blue",add=TRUE)
curve(vbTypical(x,Linf=coef2),from=0,to=20,col="red",lwd=2,add=TRUE)
curve(vbTypical(x,Linf=coef3),from=0,to=20,col="black",lwd=2,add=TRUE)
curve(vbTypical(x,Linf=coef4),from=0,to=20,col="green",lwd=2,add=TRUE)
curve(vbTypical(x,Linf=coef5),from=0,to=20,col="orange",lwd=2,add=TRUE)
#curve(vbTypical(x,Linf=coef_avg),from = 0, to = 20, col = "grey", lwd = 2, add = TRUE)
legend("bottomright",legend=c("N. Cape: Barnstable Harbor", "N. Cape: East Dennis", "N. Cape: Provincetown Bay",
"S. Cape: Cockle Cove, Chatham", "S. Cape: Eel Pond E. Falmouth"),
col=c("black","orange", "green", "red", "blue"),lwd=2,lty=1,cex=.75, title = "Sites in Cape Cod")
library(ggplot2)
library(ggpubr)
install.packages("ggpubr")
library(ggplot2)
library(ggpubr)
library(dplyr)
library(kableExtra)
install.packages("kableExtra")
library(ggplot2)
library(ggpubr)
library(dplyr)
library(kableExtra)
library(Hmisc)
install.packages("Hmisc")
library(ggplot2)
library(ggpubr)
library(dplyr)
library(kableExtra)
library(Hmisc)
library(tidyverse)
install.packages("tidyverse")
library(ggplot2)
library(ggpubr)
library(dplyr)
library(kableExtra)
library(Hmisc)
library(tidyverse)
dir_data <- "~/GitHub/EAD-ASEB-Ssolidissima-OA/projects/Seawater data/data/Carbonate chem/"
#carb_dat <- read.csv(paste(dir_data,"Surfclam_carbonate_data_wgraphs.csv", sep = ""), stringsAsFactors = FALSE)
#carb_dat <- read.csv(paste(dir_data,"Surfclam_carbonate_data_corrected.csv", sep = ""), stringsAsFactors = FALSE)
carb_dat <- read.csv("~/Documents/GitHub/EAD-ASEB-Ssolidissima-OA/projects/Seawater data/data/Carbonate chem/Surfclam_transplant_carbonate_data_flagged.xlsx - Transplant_site_data.csv", stringsAsFactors = FALSE)
#str(carb_dat)
carb_dat$Date <- as.POSIXct(carb_dat$Date, format = "%m/%d/%Y")
carb_dat <- carb_dat[!is.na(carb_dat$Date),]
carb_dat$Site[carb_dat$Site == "Eel Pond"] <- "Eel"
carb_dat$Site[carb_dat$Site == "Provincetown"] <- "Ptown"
carb_dat$Site[carb_dat$Site == "East Dennis (aquaculture)"] <- "Den"
carb_dat$Site[carb_dat$Site == "East Dennis"] <- "Den"
carb_dat$Experiment <- NA
carb_dat[carb_dat$Date<="2022-08-30 EDT","Experiment"] <- "Experiment 1"
carb_dat[carb_dat$Date>"2022-08-30 EDT","Experiment"] <- "Experiment 2"
carb_dat$Site <- as.factor(carb_dat$Site)
carb_dat <- carb_dat[carb_dat$Stratum!= "2cm control",] #Only include animal cages
#carb_dat$Stratum[carb_dat$Stratum== "2cm control"] <- "2cm" #Pooling all samples for now
carb_dat$Stratum <- as.factor(carb_dat$Stratum)
carb_dat$Shell.treatment[carb_dat$Shell.treatment=="shell"] <- "Shell"
carb_dat$Shell.treatment[carb_dat$Shell.treatment=="No shell"] <- "No Shell"
carb_dat$Shell.treatment <- as.factor(carb_dat$Shell.treatment)
#unique(carb_dat$Shell.treatment)
carb_dat$Site<- factor(carb_dat$Site,levels =c("Ptown","Eel","Den"))
#str(carb_dat)
carb_dat$season <- cut(lubridate::yday(carb_dat$Date - lubridate::days(79)),
breaks = c(0, 93, 187, 276, Inf),
labels = c("Spring", "Summer", "Autumn", "Winter"))
# carb_dat$pH_all_points <- carb_dat$pH..pH.DIC.
# carb_dat$pH_all_points[!is.na(carb_dat$pH_total_scale_final)] <- carb_dat$pH_total_scale_final[!is.na(carb_dat$pH_total_scale_final)]
carb_dat$InSitu.pH <- carb_dat$pH_total_scale_final
#carb_dat$InSitu.pH <- carb_dat$pH_all_points
carb_dat$Arg.saturation <- carb_dat$Omega_Ar_final
carb_dat <- carb_dat[carb_dat$Calculation.method!="bad",]
carb_dat <- carb_dat[carb_dat$Calculation.method!="questionable",]
carb_dat <- carb_dat[!is.na(carb_dat$InSitu.pH),]
carb_dat.all <- carb_dat
carb_dat.LM <- carb_dat[carb_dat$Stratum!="",]
carb_dat.LM <- carb_dat[carb_dat$Shell.treatment!="outside cage",]
carb_dat.exp1 <- carb_dat.LM[carb_dat.LM$Experiment=="Experiment 1",]
carb_dat.exp2 <- carb_dat.LM[carb_dat.LM$Experiment=="Experiment 2",]
# str(carb_dat.LM)
#carb_dat$Stratum <- as.factor(as.character(carb_dat$Stratum))
# summary(lm(data = carb_dat.exp1, Arg.saturation ~ Stratum * Site * Shell.treatment))
anova.m1 <- summary(lm(data = carb_dat.exp1, InSitu.pH ~ Stratum * Site * Shell.treatment))
anova.m2 <- summary(lm(data = carb_dat.exp2, InSitu.pH ~ Stratum * Site * Shell.treatment))
anova.m1 <- summary(lm(data = carb_dat.exp1, InSitu.pH ~ Stratum * Site * Shell.treatment))
anova.m2 <- summary(lm(data = carb_dat.exp2, InSitu.pH ~ Stratum * Site * Shell.treatment))
kable(anova.m1$coefficients) %>%
kable_styling(bootstrap_options = c("striped"))
kable(anova.m2$coefficients) %>%
kable_styling(bootstrap_options = c("striped"))
carb_dat.LM|>
group_by(Experiment, Stratum, Site, Shell.treatment) |>
summarise(Mean = mean(InSitu.pH),
Median = median(InSitu.pH),
St_Dev = sd(InSitu.pH),
Max = max(InSitu.pH),
Min = min(InSitu.pH),
Count = length(InSitu.pH))
carb_dat.LM|>
group_by(Experiment, Stratum, Site, Shell.treatment) |>
summarise(Mean = -log(mean(10^(-InSitu.pH)),base=10),
Median = -log(median(10^(-InSitu.pH)),base=10),
St_Dev = -log(sd(10^(-InSitu.pH)),base=10),
Max = -log(max(10^(-InSitu.pH)),base=10),
Min = -log(min(10^(-InSitu.pH)),base=10),
Count = length(InSitu.pH))
carb_dat.LM|>
group_by(Experiment, Stratum, Site) |>
summarise(Mean = -log(mean(10^(-InSitu.pH)),base=10),
Median = -log(median(10^(-InSitu.pH)),base=10),
St_Dev = -log(sd(10^(-InSitu.pH)),base=10),
Max = -log(max(10^(-InSitu.pH)),base=10),
Min = -log(min(10^(-InSitu.pH)),base=10),
Count = length(InSitu.pH))
carb_dat.LM$Omega_Ar..DIC.Alk.
carb_dat.LM|>
group_by(Experiment, Stratum, Site, Shell.treatment) |>
summarise(Mean = mean(Alkalinity),
Median = median(Alkalinity),
St_Dev = sd(Alkalinity),
Max = max(Alkalinity),
Min = min(Alkalinity),
Count = length(Alkalinity))
carb_dat.LM|>
group_by(Experiment, Stratum, Site, Shell.treatment) |>
summarise(Mean = mean(Salinity),
Median = median(Salinity),
St_Dev = sd(Salinity),
Max = max(Salinity),
Min = min(Salinity),
Count = length(Salinity))
carb_dat.LM|>
group_by(Experiment, Stratum, Site, Shell.treatment) |>
summarise(Mean = mean(Omega_Ar..DIC.Alk.),
Median = median(Omega_Ar..DIC.Alk.),
St_Dev = sd(Omega_Ar..DIC.Alk.),
Max = max(Omega_Ar..DIC.Alk.),
Min = min(Omega_Ar..DIC.Alk.),
Count = length(Omega_Ar..DIC.Alk.))
carb_dat.LM|>
group_by(Experiment, Stratum, Site, Shell.treatment, Date) |>
summarise(Mean = mean(InSitu.pH),
Median = median(InSitu.pH),
St_Dev = sd(InSitu.pH),
Max = max(InSitu.pH),
Min = min(InSitu.pH),
Count = length(InSitu.pH))
dat <- carb_dat.LM|>
group_by(Experiment, Stratum, Site, Shell.treatment, Date) |>
summarise(Mean = mean(InSitu.pH),
Median = median(InSitu.pH),
St_Dev = sd(InSitu.pH),
Max = max(InSitu.pH),
Min = min(InSitu.pH),
Count = length(InSitu.pH))
dat1 <- carb_dat.LM|>
group_by(Experiment, Stratum, Site, Shell.treatment, Date) |>
summarise(Mean = mean(InSitu.pH),
Median = median(InSitu.pH),
St_Dev = sd(InSitu.pH),
Max = max(InSitu.pH),
Min = min(InSitu.pH),
Count = length(InSitu.pH))
reshape(dat1, idvar = "name", timevar = "numbers", direction = "wide")
reshape(dat1, Experiment = "name", Date = "numbers", direction = "wide")
summary(Indometh)
head(Indometh)
dat1 <- carb_dat.LM|>
group_by(Experiment, Stratum, Site, Shell.treatment, Date) |>
summarise(Mean = mean(InSitu.pH),
Median = median(InSitu.pH),
St_Dev = sd(InSitu.pH),
Max = max(InSitu.pH),
Min = min(InSitu.pH),
Count = length(InSitu.pH))
head(Indometh)
reshape(dat1, idvar = "Experiment", timevar = "Date", direction = "wide")
reshape(dat1, idvar = c("Experiment", "Stratum","Shell.treatment"), timevar = "Date", direction = "wide")
reshape(dat1, idvar = c("Experiment", "Stratum"), timevar = "Date", direction = "wide")
values_from = c("Experiment", "Stratum", "Site)
dat1 <- carb_dat.LM|>
group_by(Experiment, Stratum, Site, Shell.treatment, Date) |>
summarise(Mean = mean(InSitu.pH),
Median = median(InSitu.pH),
St_Dev = sd(InSitu.pH),
Max = max(InSitu.pH),
Min = min(InSitu.pH),
Count = length(InSitu.pH))
dat1 %>%
pivot_wider(
names_from = Shell.treatment,
names_sep = ".",
dat1 <- carb_dat.LM|>
group_by(Experiment, Stratum, Site, Shell.treatment, Date) |>
summarise(Mean = mean(InSitu.pH),
Median = median(InSitu.pH),
St_Dev = sd(InSitu.pH),
Max = max(InSitu.pH),
Min = min(InSitu.pH),
Count = length(InSitu.pH))
dat1 %>%
pivot_wider(
names_from = Shell.treatment,
names_sep = ".",
values_from = InSitu.pH
)
dat1 <- carb_dat.LM|>
group_by(Experiment, Stratum, Site, Shell.treatment, Date) |>
summarise(Mean = mean(InSitu.pH),
Median = median(InSitu.pH),
St_Dev = sd(InSitu.pH),
Max = max(InSitu.pH),
Min = min(InSitu.pH),
Count = length(InSitu.pH))
dat1 %>%
pivot_wider(
names_from = Shell.treatment,
names_sep = ".",
values_from = Mean
)
dat1 <- carb_dat.LM|>
group_by(Experiment, Stratum, Site, Shell.treatment, Date) |>
summarise(Mean = mean(InSitu.pH))
dat1 %>%
pivot_wider(
names_from = Shell.treatment,
names_sep = ".",
values_from = Mean
)
wide <- dat1 %>%
pivot_wider(
names_from = Shell.treatment,
names_sep = ".",
values_from = Mean
)
wide$Shell-wide$`No Shell`
wide$diff <- wide$Shell-wide$`No Shell`
wide
wide$Experiment=="Experiment 1"
w.1 <- wide[wide$Experiment=="Experiment 1"]
w.1 <- wide[wide$Experiment=="Experiment 1",]
w.2 <- wide[wide$Experiment=="Experiment 2",]
anova.diff <- summary(lm(data = w.1, InSitu.pH ~ Stratum * Site * Shell.treatment))
anova.diff <- summary(lm(data = w.1, Mean ~ Stratum * Site * Shell.treatment))
anova.diff <- summary(lm(data = w.1, Mean ~ Stratum * Site))
anova.diff <- summary(lm(data = w.1, Mean ~ Stratum * Site))
w.1
anova.diff <- summary(lm(data = w.1, diff ~ Stratum * Site))
(anova.diff <- summary(lm(data = w.1, diff ~ Stratum * Site)))
(anova.diff <- summary(lm(data = w.2, diff ~ Stratum * Site)))
dat1 <- carb_dat.LM|>
group_by(Experiment, Stratum, Site, Shell.treatment, Date) |>
summarise(Mean = mean(InSitu.pH))
wide <- dat1 %>%
pivot_wider(
names_from = Shell.treatment,
names_sep = ".",
values_from = Mean
)
wide$diff <- wide$Shell-wide$`No Shell`
w.1 <- wide[wide$Experiment=="Experiment 1",]
w.2 <- wide[wide$Experiment=="Experiment 2",]
w.1
(anova.diff <- summary(lm(data = w.1, diff ~ Stratum * Site)))
(anova.diff <- summary(lm(data = w.2, diff ~ Stratum * Site)))
ggplot(w.1, aes(Date,Stratum))+
geom_point()
ggplot(w.1, aes(x=Date,colour = Stratum))+
geom_point()
ggplot(w.1, aes(x=Date,y = diff,colour = Stratum))+
geom_point()
ggplot(w.1, aes(x=Stratum,y = diff))+
geom_point()
ggplot(w.1, aes(x=Stratum,y = diff))+
geom_violin()
ggplot(w.1, aes(x=Stratum,y = diff))+
geom_violin()
ggplot(w.2, aes(x=Stratum,y = diff))+
geom_violin()
ggplot(w.2, aes(x=Stratum,y = diff, colour = Stratum))+
geom_violin()
ggplot(w.2, aes(x=Site,y = diff, colour = Stratum))+
geom_violin()
ggplot(w.1, aes(x=Site,y = diff, colour = Stratum))+
geom_bar()
ggplot(w.1, aes(x=Site,y = diff, colour = Stratum))+
geom_boxplot()
ggplot(w.1, aes(x=Site,y = diff, colour = Stratum))+
geom_boxplot()
ggplot(w.2, aes(x=Site,y = diff, colour = Stratum))+
geom_boxplot()
ggplot(w.1, aes(x=Site,y = diff, colour = Stratum))+
geom_boxplot()
ggplot(w.2, aes(x=Site,y = diff, colour = Stratum))+
geom_boxplot()
ggplot(w.1, aes(x=Site,y = diff, colour = Stratum))+
geom_boxplot()
ggplot(w.2, aes(x=Site,y = diff, colour = Stratum))+
geom_boxplot()
dat1 <- carb_dat.LM|>
group_by(Experiment, Stratum, Site, Shell.treatment, Date) |>
summarise(Mean = mean(InSitu.pH))
wide <- dat1 %>%
pivot_wider(
names_from = Shell.treatment,
names_sep = ".",
values_from = Mean
)
wide$diff <- wide$Shell-wide$`No Shell`
w.1 <- wide[wide$Experiment=="Experiment 1",]
w.2 <- wide[wide$Experiment=="Experiment 2",]
w.1
(anova.diff <- summary(lm(data = w.1, diff ~ Stratum * Site)))
(anova.diff <- summary(lm(data = w.2, diff ~ Stratum * Site)))
ggplot(w.1, aes(x=Date,y = diff,colour = Stratum))+
geom_point()
ggplot(w.1, aes(x=Site,y = diff, colour = Stratum))+
geom_boxplot()
ggplot(w.2, aes(x=Site,y = diff, colour = Stratum))+
geom_boxplot()
